\documentclass[11pt,twoside,openright]{report}

\input{control/ru.tex}
\input{control/packages.tex}
\input{control/sizes.tex}
\input{control/gost.tex}
\input{control/biblio.tex}
\input{control/greek.tex}
\input{control/the.tex}
\input{control/theorem.tex}
\input{control/shorten.tex}
\input{control/headings.tex}

\graphicspath{{media/}}

%\nofiles
\begin{document}

\input{txt/title.tex}
\input{txt/-title.tex}

\newpage
\tableofcontents

\input{txt/intro.tex}
\input{txt/i.tex}
\input{txt/ii.tex}

\chapter{
  АЛГОРИТМЫ РЕШЕНИЯ ЗАДАЧ МАРШРУТИЗАЦИИ С~ОГРАНИЧЕНИЯМИ
}
%\setcounter{section}{1}\setcounter{subsection}{1}
\setcounter{chapter}{5}
\setcounter{equation}{0}



\section{
  Введение
}
\label{sect:5.1}

В данной главе рассматриваются точные и эвристические алгоритмы решения задач
маршрутизации с ограничениями, а также различные комбинации таких алгоритмов.

Сначала приводятся точные алгоритмы на основе ДП, позволяющие получать
оптимальный результат. Размерность решаемых задач ограничена несколькими десятками
контуров, что, в принципе, соответствует некоторым типам раскроя. Проблема с
размерностью заключается в том, что данный алгоритм имеет экспоненциальный
рост времени счета и размера требуемой оперативной памяти.
Кроме того, в задачах оптимизации движения режущего инструмента важную роль
играет точное соблюдение всех ограничений;

Важный момент, который следует отметить особо, состоит в том,
что время счета и память сильно зависят от количества вложенных контуров, приводящих
к условиям предшествования. Здесь речь идет о деталях с внутренними отверстиями
и областями, и о других, меньших делалях, размещенных внутри этих областей.
В случае простых деталей, не имеющих врутренних вырезаемых областей или
отверстий, размерность решаемой задачи снижается, как показывает вычислительный
эксперимент, на несколько контуров за счет снижения количества условий
предшествования.

Принципиально иной подход к решению рассматриваемых задач состоит в применении
эвристических алгоритмов. Данные алгоритмы строятся на основе эмпирических
правил и не подтверждаются оценками. Следовательно, говорить об оптимальности
здесь невозможно. Более того, нельзя сказать, насколько тот или иной результат
отличается от оптимального значения. Можно лишь производить сравнение с результатами
для точных алгоритмов на примерах задач, имеющих сравнительно малую размерность.
Конечно, результаты работы эвристических алгоримов на примерах <<малых>>
задач могут сильно отличаться от аналогичных результатов на <<больших>> примерах
(сотни и тысячи контуров). Следовательно, упомянутое сравнение может дать лишь
общее представление о работе того или иного эвристического алгоритма.
Сильной стороной эвристических алгоритмов является их высокая производительность
и, во многих случаях, полиномиальная зависимость времени счета и объема
требуемой памяти от размерности задачи. Кроме того, эвристические алгоритмы
позволяют в полной мере учитывать детально проработанные тепловые и геометрические
ограничения.

Третий подход к решению задач реализации раскроя состоит в использовании
вставок на основе ДП. Сначала производятся вычисления
с использованием эвристического алгоритма, после чего участки маршрута
реорганизуются с использованием ДП (данные вставки охватывают участки маршрута
с размером, приемлемым для ДП). Такой подход уже не может претендовать на
оптимальность, точных оценок здесь также нет, что автоматически причисляет
его к разряду эвристических. Основная идея состоит в том, что мы применяем
к участкам маршрута и трассы гарантированно неухудшающие преобразования.
Здесь опять возникают проблемы, присущие методу ДП, --- малая размерность
вставок и большое время счета.

Для учета тепловых и геометрических ограничений могут быть применены
два подхода (в обоих используется зависимость от списка вырезанных к данному
моменту контуров). В первом реализуется дополнительное жесткое ограничение,
запрещающее перемещение на тот или иной контур, не согласующийся с тепловыми
или геометрическими ограничениями. Во втором подходе такое перемещение разрешено,
но к функции стоимости перемещения добавляется дополнительный штраф (большое
число). В настоящей монографии используется второй подход.
Рассматриваемая в предыдущих главах схема решения на основе ДП
допускает применение функций стоимости такого типа и вполне реализуема для
задач малой размерности. При решении же практических задач, связанных с
листовой резкой и имеющих ощутимую размерность, серьезную проблему
представляет само построение функций стоимости с упомянутой особенностью
(фактическая размерность резко возрастает при учете зависимости от списков
заданий). В настоящей главе приведен эффективный эвристический алгоритм, не
предусматривающий априорного построения упомянутых усложненных функций
стоимости и реализующий построение их фрагментов по мере развития процесса.
Данный алгоритм пригоден для решения маршрутных задач с ограничениями
различных типов, имеющих достаточно большую размерность.

Все вычисления производились на ПЭВМ с процессором Intel i7-2630QM с 8Гб
оперативной памяти, работающей под управлением Windows 7 (64-bit). Для
разработки программы была использована среда Microsoft Visual C++ 2013.

\section{
  Задача маршрутизации перемещений (частная постановка)
}
\label{sect:5.2}
\setcounter{equation}{0}

В настоящем разделе мы следуем конструкциям главы~3 и рассматриваем далеко не самый
общий случай постановки, ориентированной на применение  в задаче маршрутизации
движения инструмента при листовой резке на машинах с ЧПУ. Содержательное обсуждение
задачи приведено в главе~3 и в первой части монографии. Сейчас мы остановимся только
на одном моменте, связанном с ограничениями, придерживаясь содержательного способа
изложения.

Мы полагаем (как и в главе~3) заданными мегаполисы $M_1,\ldots,M_N,$ которые в
нашей конкретной задаче являются непустыми конечными множествами на плоскости,
располагающимися на некоторых <<вторичных>> эквидистантах. Имеются  отношения
$\bbm_1,\ldots,\bbm_N;$ при этом $\bbm_j\subset M_j\times M_j.$ Элементами
$\bbm_j,$ где $j\in \ov{1,N},$ являются упорядоченные пары $(x,y),$ где $x$ ---
возможная точка врезки, а $y$ --- точка выключения инструмента; разумеется, $x$
и $y$ --- суть плоские векторы. В этой связи отметим, что в качестве объемлющего
множества $X$ далее используется плоскость:
$$X = \bbr\times \bbr$$
(в качестве $X$ может использоваться также достаточно большой прямоугольник на
плоскости). Сохраняем определения множеств $\mathbf{M}_1,\ldots,\mathbf{M}_N,
\bbx$ и $\mathbf{X},$ которые были введены в главе~3. В настоящем разделе
предполагаем заданными операторы (\ref{3.3.9}); каждый из этих операторов
сопоставляет точке множества $\mathbf{X}$ непустое конечное множество на
плоскости, причем, как уже отмечалось в главе~3 (см. замечание после
(\ref{3.3.11})) в определении $A_1,\ldots,A_N$ допускается определенная
избыточность; существенная <<часть>> данных определений реализована (для
одного из возможных вариантов) в замечании~\ref{z3.3.2}.

В непосредственных расчетах использовался несколько иной вариант определения
$A_1,\ldots,A_N$ (ограничиваемся определением значений, существенных для
рассматриваемой маршрутной задачи).
Пусть
$$\rho:\,X\times X \longrightarrow [0,\infty[$$
есть обычная евклидова метрика на $X;$ при $x_1\in X$ и $x_2\in X$ число
$$\rho(x_1,x_2)\in [0,\infty[$$
определяет, следовательно, евклидово   расстояние между плоскими векторами
$x_1$ и $x_2.$ Рассмотрим нужный вариант, фиксируя $j\in\ov{1,N}$ и полагая
(это достаточно для всех наших целей), что $x\in \mathbf{X}\setminus
\mathbf{M}_j.$ По самому смыслу оператора $A_j$ (\ref{3.3.9}) имеем, что
множество $A_j(x)$ исчерпывает возможности выбора новой точки врезки при
условии перемещения в мегаполис из состояния $x,$ которое не принадлежит
$\mathbf{M}_j:$ мы имеем возможность выбирать только векторы $y\in A_j(x).$
Одно из соображений, определяющих упомянутое ограничение, может состоять в
том, чтобы новая точка врезки выбиралась в отдалении от предыдущей. Здесь,
конечно, надо иметь в виду, что реально у нас либо $x=x^o,$ либо $x$ является
точкой выключения инструмента и может не совпадать с предыдущей точкой врезки.
Однако в рассматриваемой задаче <<парные>> точка врезки и точка выключения
(инструмента) близки, а потому можно считать, что предыдущая точка врезки
находится вблизи $x$ и, удаляясь от $x,$ мы удаляемся и от упомянутой предыдущей
точки врезки.

Будем полагать заданным некоторое число $\mathbf{r}_j(x)\in [0,\infty[$
(пороговый уровень) и весовой коэффициент $\xi_j(x) \in ]0,1];$ введем
значение
$$d_j(x) \df \max\limits_{h\in \bbm_j}\rho\bigl(x,\mathrm{pr}_1(h)\bigl);$$
в нашем случае $d_j(x) > 0.$ Определяем множество $A_j(x)$ следующими тремя
выражениями:
$$\bigl(d_j(x) < \mathbf{r}_j(x)\bigl)\Longrightarrow \Bigl(A_j(x) \df
\bigl\{\mathrm{pr}_1(y):\,y\in \bbm_j,\ \xi_j(x) d_j(x) \leqslant \rho
\bigl(x,\mathrm{pr}_1(y)\bigl)\bigl\}\Bigl),
$$
$$\biggl(\Bigl(\min\limits_{h\in \bbm_j}\rho\bigl(x,\mathrm{pr}_1(h)\bigl)
\leqslant \mathbf{r}_j(x)\Bigl)\,\&\,\bigl(\mathbf{r}_j(x)\leqslant d_j(x)
\bigl)\biggl) \Longrightarrow $$ $$\Longrightarrow\Bigl(A_j(x) \df \bigl
\{\mathrm{pr}_1(z):\,z\in \bbm_j,\ \mathbf{r}_j(x) \leqslant \rho\bigl(x,
\mathrm{pr}_1(z)\bigl)\bigl\}\Bigl),
$$
$$\Bigl(\mathbf{r}_j(x) < \min\limits_{h\in\bbm_j}\rho\bigl(x,
\mathrm{pr}_1(h)\bigl)\Bigl)\Longrightarrow \bigl(A_j(x) \df
\{\mathrm{pr}_1(h):\,h\in \bbm_j\}\bigl).
$$
В первом из соотношений говорится о <<хоть каком-то>> уклонении от предыдущей
точки врезки (число $\xi_j(x)$ логично выбирать близким к 1); речь идет об
обработке <<плохих>>  в упомянутом смысле случаев. Второе соотношение
характеризует пороговое разделение множества новых точек врезки на два
подмножества, одно из которых и трактуется как $A_j(x).$ Наконец, третье
соотношение отвечает <<хорошему>> в смысле упомянутой удаленности случаю,
когда любые точки врезки нового мегаполиса доступны для перемещения.

Заметим, что упомянутое <<тройственное>> определение обеспечивает условие
$A_j(x) \neq \emp,$ хотя при $d_j(x) < \mathbf{r}_j(x)$ за это условие
приходится <<расплачиваться>> качеством реализации порогового уровня
$\mathbf{r}_j(x);$ по сути дела мы действуем в случае упомянутого строгого
неравенства по остаточному принципу. Тем не менее определенные меры в части
осуществления удаленности новой точки врезки от предыдущей удается реализовать
и обеспечить тем самым постановку задачи (\ref{3.3.31}) в ее конкретном варианте.

При построении алгоритма использовались соглашения:
$$\bigl(\mathbf{r}_j(x) = \mathbf{r}\ \ \fa j\in \ov{1,N}\ \ \fa x\in
\mathbf{X}\setminus \mathbf{M}_j\bigl)\,\&\,\bigl(\xi_j(x) = \xi\ \ \fa
j\in \ov{1,N}\ \ \fa x\in \mathbf{X}\setminus \mathbf{M}_j\bigl)
$$
(напомним, что при доопределении вышеупомянутых <<тройственных>> правил до
отображений на всем множестве $\mathbf{X}$ использовались соображения, подобные
изложенным в разделе~3.3 после соотношения (\ref{3.3.11})); здесь $\mathbf{r}>0$
и $1 \geqslant\xi >0.$

Рассматриваемые в книге примеры связаны с машинами резки металла на станках с ЧПУ.
Функции стоимости представляют из себя не расстояния, а времена движения инструмента.
Все перемещения осуществляются либо на скорости холостого хода $V_i,V_i>0$,
либо на скорости реза
$V_c, V_c > 0$.
Скорость холостого хода превышает скорость
реза в десятки и сотни раз. В примерах $V_i=500$ мм/с, а $V_c=10$ мм/с.
Движение предполагается безинерционным.
Точка $x^0$ задается в виде начала координат: $x^0=(0,0)$.
Для $x_1\in \mathbf{X}$ и $x_2\in \mathbb{X}$ полагаем
\begin{equation}\label{ExtPrice}
\mathbf{c}(x_1,x_2)=\frac{\rho (x_1,x_2)}{V_i}.
\end{equation}

Функции стоимости внутренних работ вычисляются с учетом скорости реза.
Именно, для $i\in \overline{1,N}$, $z\in \mathbb{M}_i$
$$
c_i(z)=\frac{\rho(\mbox{pr}_1(z),u(z))+\rho(u(z),\mbox{pr}_2(z))}{V_c},
$$
где вектор $u(z)$ находится на эквидистанте и сопоставляется $z$ однозначно.
Функция $f$ также определяется временем движения в финишную точку.
\begin{equation}\label{TerminalPrice}
f(x)=\frac{\rho (x,x^0)}{V_i}.
\end{equation}
%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

%*******************************************************************************
В примере рассматривался случай $N=29$ и $|\mathbf{K}| =30$. Использовалось
<<тройственное>> определение операторов $A_1,\ldots,A_N$ при следующей
конкретизации параметров:
$$
\mathbf{r}=100,\ \xi=0,75.
$$
Точное описание мегаполисов не приводится по соображениям объема; отметим
только, что мощности $|M_i|, i\in \overline{1,29}$, имеют значение от 3 до 30.

\begin{figure}
  \begin{center}
  \includegraphics[width=0.9\textwidth]{route_29_DP_AD.png}
  \caption{Траектория, построенная на основе ДП}
  \label{DP_Result}
  \end{center}
\end{figure}

Результат счета 100,61, время счета 13 мин. 13 сек. Маршрут и трасса показаны
на рис. \ref{DP_Result}.

\section{
  Итерационный режим с комбинированием оптимизирующих вставок разной <<длины>>
}
\label{sect:5.3}
\setcounter{equation}{0}

Начиная с настоящего раздела мы рассматриваем конструкции решения задачи
(\ref{4.4.13}) с использованием оптимизирующих вставок. Основное внимание
здесь и далее уделяется итерационным алгоритмам на основе подходов,
сформулированных в заключении предыдущей главы. Будем придерживаться
обозначений раздела~4.4 в части описания элементов <<большой>> задачи
(см. (\ref{4.4.13})), а, в части описания локальных задач, --- обозначений
раздела~4.3. Итак, схема ДП раздела~4.3 используется при построении
оптимизирующих вставок, направленных на обеспечение   локального улучшения
ДР <<большой>> задачи. Последняя рассматривалась на уровне построения
алгоритмов и программ в реализации, ориентированной на применение для
целей маршрутизации движения инструмента при листовой резке на станках
с ЧПУ.

Сначала совсем кратко напомним итерационную процедуру, в рамках которой
предполагалось сочетание оптимизирующих вставок разной <<длины>>. Как и
в разделе~4.4, полагаем, что $\nn\in \bbn$ определяет количество мегаполисов
<<большой>> задачи; значение $\nn$ полагается достаточно большим, а потому
непосредственное применение ДП (см. раздел~4.3) для целей <<глобальной>>
оптимизации практически невозможно. Пусть, однако, задано число
$N\in \bbn,$ определяющее размер или <<длину>> вставки; при этом
в последующих конструкциях полагается, что при данном значении $N$ в
локальной задаче маршрутизации, возникающей при построении вставки,
процедура на основе ДП уже позволяет осуществить вычисления, приводящие
к построению оптимального локального решения (имеется в виду вариант
задачи (\ref{4.3.3})) и нахождению значения (\ref{4.3.5}), то есть
экстремума локальной задачи.

Некоторую проблему составляет выбор начала вставки, которое в разделе~4.4
было обозначено через $\nu$ (см. (\ref{4.4.24})). Конечно, данный параметр
можно выбрать как угодно, соблюдая (\ref{4.4.24}); при этом, как показано в
главе~4, значение критерия <<большой>> задачи не ухудшится. Однако желательно
устраивать вставку там, где она обеспечит реальное улучшение совокупного
критерия; таким образом, <<момент>> начала вставки надо искать, исходя из
соображений, связанных с улучшением критерия. В конце главы~4 были намечены
некоторые подходы к выбору параметра $\nu.$ Все эти подходы связывались с
организацией той или иной итерационной процедуры. Мы начнем сейчас с
рассмотрения того варианта данной процедуры, когда для поиска $\nu$
привлекается система вставок меньшего размера. Последнее существенно, так
как на каждом этапе основной итерационной процедуры  приходится (в рамках
данного подхода) проигрывать реализацию поисковых вставок многократно.
Цель этих построений, как  уже отмечалось в главе~4, состоит в определении
такого значения $\nu,$ для которого исходное эвристическое ДР было бы
наиболее <<податливо>> к улучшению. Последнее же предлагается осуществлять
с помощью вставки большего размера (большей <<длины>>). Итак, мы рассматриваем
вставки разной <<длины>>, придавая значению $N$ одно из двух значений
$$(N = N_1) \vee (N=N_2),
$$
где $2 \leqslant N_1 < N_2 <\nn.$ Соответственно у нас на каждом этапе
возникают (зондирующие) $N_1$-вставки и одна рабочая $N_2$-вставка.

При этом, как уже отмечалось в заключительной части главы~4, значение
$N_1$ подбирается таким, чтобы было возможно <<прорешать>> все локальные
маршрутные задачи в диапазоне $\ov{0,\nn-N_2}.$ Правда при решении упомянутых
локальных задач не требуется находить оптимальные маршрут и трассу; требуется
только <<быстро>> определять экстремумы; в настоящем варианте для этого
использовалось ДП в духе процедуры (\ref{4.3.13}), финалом которой является
определение экстремума локальной маршрутной задачи.

%*******************************************************************************
В примере рассматривался случай $\mathbf{n}=75$ и $|\mathbf{K}|=37$. Размеры вставок
были выбраны следующими: $N_1=12$, $N_2=24$.
Функции стоимости выбраны такими же, как в предыдущем примере (из раздела
5.2). Количество итераций равнялось
15. Начальный вариант посчитан с использованием эвристического итерационного
алгоритма, значение полученного критерия равно 250,79. Результат, достигнутый
после применения вставок ДП равен 249,3. Общее время счета составляет 17
мин. 3 сек. Маршрут и трасса показаны на рис. \ref{DP_Inserts_Result}.

\begin{figure}
  \begin{center}
  \includegraphics[width=0.9\textwidth]{routing_75_checking_ins.png}
  \caption{
    Траектория, полученная с использованием эвристического алгоритма
    с~улучшающими вставками ДП
    }
  \label{DP_Inserts_Result}
  \end{center}
\end{figure}

\section{
  Итерационный режим с элементами оптимизации локальных условий
  прешествования
}
\label{sect:5.4}
\setcounter{equation}{0}

В настоящем разделе обсудим вариант итерационной процедуры раздела~4.8,
предложенный А.А.Ченцовым и связанный с использованием задачи (\ref{4.8.5}).
Мы сохраняем символику главы~4 как в части описания <<большой>> задачи, так
и в части описания локальных задач типа (\ref{4.2.5}). Как уже отмечалось
в разделе~4.8, данный вариант ориентирован на построение оптимизирующих вставок,
в которых количество адресных пар должно быть достаточно большим; это позволяет
в определенной степени снижать сложность вычислений по методу ДП.

Введем в рассмотрение множество
\bfn\label{5.4.1}\bbd \df \bigl\{\bigl(\al,(z_i)_{i\in\ov{0,\nn}})\in \ca
\times \mathfrak{Z}|\,(z_i)_{i\in\ov{0,\nn}}\in \mathfrak{Z}_\al\bigl\}
\efn
всех ДР <<большой>> задачи, после чего на множестве
$$\bbd \times \ov{0,\mathbf{k}},
$$
где $\mathbf{k}\in \bbn,\,\mathbf{k}\leqslant \nn-N,$ фиксировано,
определим многозначное  отображение
\bfn\label{5.4.2}\Phi:\,\bbd\times \ov{0,\mathbf{k}}\longrightarrow
\cp^\prime(\ov{0,\mathbf{k}}).
\efn
Отображение (\ref{5.4.2}) может, в принципе, определяться по разному, но
мы пока зафиксируем какой-либо вариант $\Phi$ с тем, чтобы изложить логику
возникающей итерационной процедуры, после чего конкретизируем $\Phi$
(\ref{5.4.2}).

Итак, пусть сейчас $\Phi$ --- любое многозначное отображение (мультифункция)
(\ref{5.4.2}). Допустим, что тем или иным способом мы смогли определить
некоторое начальное ДР
\bfn\label{5.4.3}
(\la_o,h_o)\in \bbd
\efn
(для построения данного ДР может использоваться тот или иной эвристический
(в частности, жадный) алгоритм); выберем, кроме того, $\nu_o\in \ov{0,\mathbf{k}}.$
В результате реализуется (непустое) множество
$$\Phi(\la_o,h_o,\nu_o) = \Phi\bigl((\la_o,h_o),\nu_o\bigl)\in
\cp^\prime(\ov{0,\mathbf{k}}),
$$
после чего  осуществляется выбор индекса
\bfn\label{5.4.3`}\nu_1\in \Phi(\la_o,h_o,\nu_o),
\efn
определяющего конкретное начало вставки. Заметим, что в (\ref{5.4.3`}) может
использоваться то или иное оговоренное заранее правило выбора. Так, например,
мы можем действовать по правилу: в качестве $\nu_1$ выбираем наименьший (наибольший)
элемент множества $\Phi(\la_o,h_o,\nu_o).$ После того, как выбор (\ref{5.4.3`})
осуществлен, используем процедуру, изложенную в разделах~4.4--4.7, при условиях
\bfn\label{5.4.4}\la = \la_o, (\mathbf{h}_i)_{i\in\ov{0,\nn}}= h_o, \nu = \nu_1
\efn
((\ref{4.4.13}), (\ref{4.4.14}) и (\ref{4.4.24}) применяем в условиях (\ref{5.4.4})).
После реализации процедуры разделов~4.4--4.7 (при условиях (\ref{5.4.4})) получаем
новое ДР
\bfn\label{5.4.5}\bigl(\eta,(\hat{\mathbf{h}}_t)_{t\in\ov{0,\nn}}\bigl)\in \bbd
\efn
<<большой>> задачи, которое мы принимаем за $(\la_1,h_1);$ итак, полагаем
\bfn\label{5.4.6}\la_1 = \eta,\,h_1 = (\hat{\mathbf{h}}_t)_{t\in\ov{0,\nn}},
\efn
что соответствует построениям разделов~4.5-- 4.7. Напомним, что при этом (см.
(\ref{4.7.49}) и теорему~\ref{t4.6.1})
$$
\widehat{\mathfrak{C}}_\eta[(\hat{\mathbf{h}}_t)_{t\in\ov{0,\nn}}] \leqslant
\widehat{\mathfrak{C}}_\la[(\mathbf{h}_i)_{i\in\ov{0,\nn}}],
$$
что при наших условиях (\ref{5.4.6}) приводит к неравенству
\bfn\label{5.4.7}\widehat{\mathfrak{C}}_{\la_1}[h_1] \leqslant
\widehat{\mathfrak{C}}_{\la_o}[h_o]
\efn
(конкретная степень <<улучшения>> значений критерия указана в (\ref{4.7.49})
и теореме~\ref{t4.6.1}). Теперь мы получаем множество
$$\Phi(\la_1,h_1,\nu_1) \in \cp^\prime(\ov{0,\mathbf{k}}).
$$
Поскольку, в частности, $\Phi(\la_1,h_1,\nu_1)\neq \emp,$ осуществляем выбор
\bfn\label{5.4.8}\nu_2\in \Phi(\la_1,h_1,\nu_1),
\efn
используя то или иное правило (см. обсуждение после (\ref{5.4.3`})). Теперь
применяем процедуру, изложенную в разделах~4.4--4.7 при условиях, что
$$\la =\la_1,(\mathbf{h}_i)_{i\in\ov{0,\nn}}= h_1, \nu= \nu_2,
$$
получая в результате новый вариант ДР (\ref{5.4.5}) <<большой>> задачи,
обозначаемый сейчас через $(\la_2,h_2),$ что соответствует конкретизации
\bfn\label{5.4.9}
\eta = \la_2,(\hat{\mathbf{h}}_t)_{t\in\ov{0,\nn}}= h_2.
\efn
Итак, $(\la_2,h_2)$ получается в виде ДР, улучшающего $(\la_1,h_1):$
\bfn\label{5.4.10}
\widehat{\mathfrak{C}}_{\la_2}[h_2] \leqslant
\widehat{\mathfrak{C}}_{\la_1}[h_1].
\efn
Далее процесс повторяется заданное (или  выбираемое по мере реализации
алгоритма) число раз; обозначая данное число через $\mathbf{r},$ мы можем
говорить о кортеже
$$
s \longmapsto (\la_s,h_s):\,\ov{1,\mathbf{r}}\longrightarrow \bbd
$$
ДР <<большой>> задачи, получаемом в результате повторения процедуры
разделов~4.4--4.7 $\mathbf{r}$ раз, где $\mathbf{r}\in \bbn.$ Ясно, что
\bfn\label{5.4.11}
\widehat{\mathfrak{C}}_{\la_\mathbf{r}}[h_\mathbf{r}] \leqslant
\widehat{\mathfrak{C}}_{\la_o}[h_o]
\efn
(действительно, имеем, что $\widehat{\mathfrak{C}}_{\la_j}[h_j]\leqslant
\widehat{\mathfrak{C}}_{\la_{j-1}}[h_{j-1}]\ \ \fa j\in \ov{1,\mathbf{r}}).$
Разумеется, выбирая тот или иной вариант отображения $\Phi,$ мы получаем
(в смысле (\ref{5.4.11})) различные результаты.

Теперь мы рассмотрим конкретный вариант $\Phi,$ имея в виду применение
в алгоритме, предложенном А.А. Ченцовым. Для этого сначала введем при
$(\la,h)\in \bbd$ и $\nu\in \ov{0,\mathbf{k}}$ множество
\bfn\label{5.4.12}
\Psi_\nu[\la;h] \df \bigl\{z\in \mathfrak{K}|\,\exists\,t_1\in
\ov{1,N}\ \ \exists\,t_2\in \ov{1,N}:\,z = \bigl(\la(\nu+t_1),
\la(\nu+t_2)\bigl)\bigl\},
\efn
где $\mathfrak{K}$ --- множество всех адресных пар <<большой>>
задачи, а число $N$ соответствуют разделам~4.4--4.7 (в рассматриваемом
ниже алгоритме число $N\in \bbn$ не изменяется, в отличие от построений
предыдущего раздела). Поскольку (\ref{5.4.12}) --- конечное множество,
определена мощность
$$
|\Psi_\nu[\la;h]|\,\in \bbn_o.
$$
Теперь мы при $\mathbf{k}\geqslant 2$ конкретизируем выбор отображения
$\Phi$ следующим образом: полагаем при $(\la,h)\in \bbd$ и $\nu\in
\ov{0,\mathbf{k}},$ что
\bfn\label{5.4.13}
\Phi(\la,h,\nu) = \bigl\{\nu_o\in \ov{0,\mathbf{k}}\setminus
\{\nu\}\bigl|\,|\Psi_{\bar{\nu}}[\la;h]|\leqslant |\Psi_{\nu_o}[\la;h]|\ \
\fa \bar{\nu}\in \ov{0,\mathbf{k}}\setminus \{\nu\}\bigl\}.
\efn
Правило (\ref{5.4.13}) состоит очевидно в следующем: мы при заданном
ДР $(\la,h)\in \bbd$ назначаем такие изменения
\bfn\label{5.4.14}\nu\longrightarrow \nu_o,
\efn
при которых (см. (\ref{5.4.12})) <<окно>>, определяемое началом $\nu_o,$
содержит наибольшее число адресных пар исходной <<большой>> задачи.
При изменениях (преобразованиях) (\ref{5.4.14}) мы стремимся обеспечить
лучшую <<просчитываемость>> локальной задачи, имея в виду использование
условий предшествования <<в положительном направлении>>.



Пусть $X=\mathbb{R}\times\mathbb{R}$, $\mathbf{n}=60$,
$\mathbf{x}_0=(0,0)$,
$\vert \mathfrak{K} \vert=47$. Функцию $\mathbf{c}^{\natural}$ определяем посредством евклидова расстояния,
а значения функций $c_j^{\natural},\;j \in \overline{1,\mathbf{n}}$, --- в виде суммы евклидова расстояния
от пункта прибытия до заданного (и зависящего от $j$) плоского вектора и аналогичного расстояния от данного
вектора до пункта отправления. Алгоритмические конструкции были реализованы
А.А.Ченцовым в виде программы для ЭВМ, написанной на языке программирования C++
и работающей под управлением 64-х разрядной операционной
системы семейства Windows; вычислительная часть программы реализована в отдельном от интерфейса пользователя потоке.
По соображениям объема ограничимся изложением результатов вычислений на ПЭВМ
(в ходе вычислительного эксперимента применялся ноутбук с центральным процессором Core i7, объемом ОЗУ 6 гБ
с установленной операционной системой Windows 7 Максимальная Sp1), опуская описание мегаполисов и адресных пар;
начальное решение (пара маршрут--трасса) определялось жадным алгоритмом, соблюдающим условия предшествования
и реализующим значения критерия 4858.68 в <<незамкнутой>> задаче (функция $f^{\natural}$ тождественно равна нулю)
и 4988.18 в <<замкнутой>> задаче (значения $f^{\natural}$ определялись евкидовым расстоянием до <<нуля>>).

Итак, исходному решению и ранее используемому <<моменту>> начала
вставки сопоставляется отличное от данного <<момента>> начало вставки, максимизирующее
число адресных пар, занумерованных в соответствии с прежним маршрутом и попадающих в
окно предполагаемой вставки. В процессе счета для <<незамкнутой>> задачи
реализовались следующие показатели:

при $N=20$ результативных итераций 4, стабилизация наступила при значении критерия 4500.71;

при $N=25$ результативная итерация одна, стабилизация наступила при достижении результата 4456.51;

при $N=27$ результативная итерация одна, а достигнутое значение критерия $4446.77$;

при $N=30$ имеем одну результативную итерацию и значение критерия 4446.77.

Среднее время счета последовательно нарастало (при $N=20$ время одной итерации 36--45 сек, при $N=25$ ---
чуть более 10 минут, при $N=27$ --- уже 46 мин. 11 сек., а при $N=30$ время счета составило 5 час. 4 мин. 16 сек.).


В <<замкнутой>> задаче аналогичные показатели были следующими:

при $N=20$ результативных итераций 4, стабилизация наступила по достижении результата $4630.21$;

при $N=25$ результативная итерация одна, результат 4586.01;

при $N=27$ результативных итераций две, а достигнутый при этом результат 4576.26;

при $N=30$ имеем одну результативную итерацию и значение критерия 4576.26.

Среднее время счета сохраняло тенденцию <<незамкнутой>>, задачи (27-45 сек, 10-11 минут,
46 мин. 22 сек., 38 мин. 34 сек. в третьем случае, т.е. при $N=27$, и 5 час. 3 мин. 2 сек при $N=30$).

Таким образом, увеличивая $N$ (длина вставки), мы последовательно улучшаем
результат, затрачивая, однако, все большее время. Еще одно обстоятельство,
проявившееся в ходе вычислительного эксперимента, состоит в том, что при
$N=30$ (сравнительно большая длина вставки) получается всего одна результативная
итерация, после чего итерационная процедура стабилизируется. Это обстоятельство
можно рассматривать как некоторый косвенный <<индикатор>> приближения к
оптимальности.

\section{
  Итерационный режим со случайным расположением вставок фиксированной <<длины>>
}
\label{sect:5.5}
\setcounter{equation}{0}

Один из возможных подходов к решению проблемы выбора расположения оптимизирующей
вставки связан с организацией случайных испытаний. Точнее, имеется в виду
случайный выбор начала вставки. На этой основе был построен вариант итерационного
алгоритма, краткое изложение которого приведено в настоящем разделе.

Итак, фиксируем $\mathbf{k}\in \overline{0,\mathbf{n}-N}$ и допускаем возможность
случайного выбора начала вставки из <<интервала>> $\overline{0,\mathbf{k}}$. Такой
выбор осуществляется многократно, что приводит к реализации итерационной
процедуры. Количество итераций может задаваться заранее или определяться
по мере достижения заданного качества.

Рассмотрим несколько этапов процедуры, полагая, что на каждом из них выбор
начала вставки осуществляется на основе испытаний при использовании равномерного
распределения; значение $N$ фиксировано. Итак, пусть число $\nu_1\in \overline{0,\mathbf{k}}$
получено как результат случайного испытания. Далее используем процедуру,
изложенную в разделах 4.4-4.7 при условиях (\ref{5.4.4}), где $(\lambda_0,h_0)$
соответствует (\ref{5.4.3}) и является ДР, определенным с помощью какого-либо
эвристического алгоритма. Мы используем (\ref{4.4.13}), (\ref{4.4.14}) и
(\ref{4.4.24}) в условиях (\ref{5.4.4}); получаем ДР (\ref{5.4.5}) исходной
<<большой>> задачи, которое принимается за $(\lambda_1,h_1)$ (см. (\ref{5.4.6})),
причем реализуется неравенство (\ref{5.4.7}).

Теперь осуществляется случайное испытание, результатом которого является
$\nu_2\in \overline{0,\mathbf{k}}$. Вновь применяется процедура, изложенная
в разделах 4.4-4.7 при условиях $\lambda=\lambda_1$,
$(\mathbf{h}_i)_{i\in \overline{0,\mathbf{n}}}=h_1$ и $\nu=\nu_2$ и доставляющая
новое ДР $(\lambda_2,h_2)$ <<большой>> задачи. При этом реализуется неравенство
(\ref{5.4.10}).

Далее процедура повторяется, доставляя в конце концов неравенство (\ref{5.4.11}),
где $\mathbf{r}\in \mathbb{N}$ определяет количество итераций.

В примере рассматривался случай $\mathbf{n}=75$ и $|\mathbf{K}|=42$. Размер вставок
был выбран следующим: $N=23$. Функции стоимости предполагались такими же, как в разделе
5.2. Количество итераций равнялось 15. Начальный вариант был посчитан с использованием
эвристического итерационного алгоритма, значение полученного критерия равно 259,51.
Результат, достигнутый после применения вставок на основе ДП равен 257,16. Общее время
счета составляет 16 мин. 11 сек. Маршрут и трасса показаны на рис.
\ref{DP_Random_Inserts_Result}.

\begin{figure}
  \begin{center}
  \includegraphics[width=0.9\textwidth]{route_random_dp_insertions.png}
  \caption{
    Траектория, полученная с использованием эвристического алгоритма
    с~улучшающими вставками на основе ДП (случайное расположение вставок)}
  \label{DP_Random_Inserts_Result}
  \end{center}
\end{figure}

\section{
  Один вариант жадного эвристического алгоритма
}
\label{sect:5.6}
\setcounter{equation}{0}

В задачах раскроя количество контуров нередко превышает несколько сотен.
Для решения таких задач предлагается использовать эвристические методы.
Кроме того, в задачах раскроя важную роль играют тепловые и
геометрические ограничения. Несоблюдение этих ограничений делает бессмысленной
оптимизацию длины пути.

Рассмотрим один из подходов к построению эвристического алгоритма для решения
задач большой размерности при наличии упомянутых ограничений. В данном подходе
оптимизирующие вставки не используются.

В качестве $X$ предполагается заданным достаточно большой прямоугольник
на плоскости, соответствующий листу металла. Процедура раскроя полагается
выполненной. В результате в пределах $X$ размещены контура деталей,
подлежащие резке по некоторым эквидистантам в виде замкнутых кривых.
С внешней по отношению к деталям стороны вблизи каждой эквидистанты
размещены конечные множества --- мегаполисы. Точки мегаполисов группируются
в упорядоченный пары. Элементами каждой такой упорядоченной пары являются точка
врезки и точка выключения инструмента. Каждой такой упорядоченной паре
сопоставляется также точка на эквидистанте, определяющая начало и завершение
реза соответствующего контура.

Как и в предыдущих разделах, фиксируются скорости холостого хода
и реза $V_i>0$ и $V_c>0$ соответственно. Значения функции $\mathbf{c}$
определяются соответствующим временем внешних перемещений. При этом точка
$x^0$ задается в виде начала координат: $x^0=(0,0)$. Функция $\mathbf{c}$
та же, что и в (\ref{ExtPrice}). Функция $f$ та же, что и в
(\ref{TerminalPrice}).

Перейдем к рассмотрению функций стоимости внутренних работ $c_1,...,c_N$,
в которых используется зависимость от списка заданий.

Пусть $j\in \overline{1,N}$, $z=(x,y)\in \mathbb{M}_j$ и
$u=u(z)$ --- отвечающая паре $z$ точка на $j$-й эквидистанте.
Кроме того, через $\tilde{D}$, $\tilde{D}\stackrel{\triangle}{=}\{0;1\}$,
обозначим множество, соответствующее возможным направлениям реза, причем $1$
определяет направление реза по часовой стрелке, $0$ --- против
часовой стрелки. Скорость реза здесь также совпадает с $V_c, V_c>0$.

Важным ограничением при резке металла является требование достаточного
количества металла возле завершающего участка реза --- рассеивание тепла
особенно важно на финишном участке.
В свете этого ограничения большую значимость приобретает направление реза.
Дело в том, что при резе в разных направлениях участок завершения реза
также оказывается с разных сторон от точки начала реза; при этом ситуация
с количеством металла с этих разных сторон может сильно различаться.

Условимся относительно следующих обозначений, применяемых ниже в целях формализации
содержательных понятий <<много металла>> и <<мало металла>>. Итак, если
$j\in \overline{1,N}$, $z\in \mathbb{M}_j$, $d\in \tilde{D}$ и
$\mathbb{K}\in \mathcal{P}(\overline{1,N}\setminus \{j\})$, то через
$S_1(j,z,d,\mathbb{K})$ обозначаем площадь пересечения заданной
области вокруг участка завершения реза и области имеющегося металла, а через
$S_2(j,z,d,\mathbb{K})$ --- площадь пересечения упомянутой области
и пустот, образовавшихся после вырезания контуров с номерами из $\mathbb{K}$,
а также внешнего пространства, выходящего за края листа. Под областью возле
участка завершения реза подразумевается геометрическая фигура, лежащая вне
детали, и такая, что расстояние от любой ее точки до ближайшей точки участка
завершения реза не превышает заданной величины (см. рис. \ref{FinishCutArea}).

\begin{figure}
  \begin{center}
  \includegraphics[width=0.9\textwidth]{CutFinishArea.png}
  \caption{Область металла возле участка завершения реза; резка против часовой
стрелки здесь более предпочтительна}
  \label{FinishCutArea}
  \end{center}
\end{figure}

Пусть $\tilde{K}, \tilde{K}\subset \overline{1,N}\setminus \{j\},$
--- множество номеров вырезанных к текущему моменту контуров,
и $k\in \tilde{K}$. На рисунке 1 изображены
два варианта реза --- по часовой стрелке и против часовой стрелки.
На рисунке область завершения реза пересекается только с вырезанным
контуром с номером $k$.

Стоимость внутренних работ по вырезанию контура с номером $j,j\in \overline{1,N},$
при использовании пары $z$ точек врезки и выключения инструмента,
$z\in \mathbb{M}_j$, в направлении $d,d\in \tilde{D},$ при условии,
что к настоящему моменту уже вырезаны контура с номерами из
$\tilde{K},\tilde{K}\subset \overline{1,N}\setminus \{j\}$, будет
вычисляться следующим образом: при $K=\overline{1,N}\setminus \tilde{K}$

\begin{equation}\label{IntPrice}
\begin{array}{c}
c_j(z,d,K)=\frac{\rho(\mbox{pr}_1(z),u(z))}{V_c}+
\frac{\rho(u(z),\mbox{pr}_2(z))}{V_c}+\\
+\frac{S_2(j,z,d,\overline{1,N}\setminus K)}{S_1(j,z,d,\overline{1,N}\setminus K)+
S_2(j,z,d,\overline{1,N}\setminus K)}\cdot\tilde{P}.
\end{array}
\end{equation}

Коэффициент $\tilde{P}$ определяет влияние штрафа
в зависимости от расположения финишной области реза. Если
$\tilde{P}=0$, то расположение финишной области никак не
сказывается на стоимости маршрута. Если $\tilde{P}$ есть
большая величина, то основная часть стоимости внутренних
работ в основном определяется вышеупомянутым штрафом, а
не временем реза на подходе к контуру.

Эвристический алгоритм показан в виде ряда шагов.
Изначально считается, что маршрут пуст. Далее к нему на
каждом шаге добавляется номер одного мегаполиса.

1. Находим мегаполис с номером $i,i\in \overline{1,N},$ для которого
$i\neq \mbox{pr}_2(z)$ $\forall z\in \mathbf{K}$, и упорядоченную пару
$(x,y)\in \mathbb{M}_i$, а также $d\in \tilde{D}$,
обеспечивающие минимум значения
$\mathbf{c}(x^0,x)+c_i((x,y),d,\overline{1,N})$.
Добавляем мегаполис $M_i$ в маршрут, а пару точек $(x,y)$ --- на трассу.
Отмечаем мегаполис $M_i$ как посещенный с направлением обхода $d$.

2. Через $V,V\subset \overline{1,N},$ обозначим множество номеров уже
посещенных мегаполисов. Пусть $j,j\in V,$ является номером
последнего мегаполиса частичного маршрута,
а $(x,y)\in \mathbb{M}_j$ его пара точек входа и выхода.
Далее находим такой номер мегаполиса $k,k\in I(\overline{1,N}\setminus V)$,
а также $(\tilde{x},\tilde{y})\in \mathbb{M}_k$ и $d\in \tilde{D}$,
которые обеспечивают минимальное значение выражения
$\mathbf{c}(y,\tilde{x})+c_k((\tilde{x};\tilde{y}),d,\overline{1,N}\setminus V)$.
Добавляем мегаполис $M_k$ в маршрут, а пару точек $(\tilde{x},\tilde{y})$
--- на трассу. Отмечаем мегаполис с номером $k$ как посещенный с направлением
обхода $d$.

3. Выполняем шаг 2 до тех пор, пока весь маршрут не будет построен.

Данный алгоритм позволяет получить некоторое допустимое решение. Так как алгоритм
жадный, то при его реализации значительный поиск глобального экстремума не производится.
Алгоритм может выдать некоторый локальный экстремум. В целях улучшения результата в
данной работе предлагается вариант многократного выполнения алгоритма с запретами
определенных перемещений, обеспечивающими возможность получения всякий раз новых
маршрута и трассы. Данные запреты осуществляются посредством изменения функций
стоимости $c_1,...,c_N$. Именно, для заданного мегаполиса значение этой функции
принимает очень большую величину, если он попадает в заранее оговоренную позицию
маршрута. Следовательно, алгоритм будет избегать посещения упомянутого мегаполиса
в данной выбранной позиции.

Для реализации этого подхода вводится специальная матрица $D$ коррекции стоимостей
внутренних работ: $D_{i,j}\in \{0;1\}$, $i\in \overline{1,N}$, $j\in \overline{1,N}$.
Если $D_{i,j}=1$, то
$$
c_i(h,d,K)=1000000\;\; \forall h\in \mathbb{M}_i,\;\;
\forall d\in \tilde{D},\;\;\forall K\in \mathcal{P}(\overline{1,N}\setminus \{i\})
$$
при условии, что мегаполис с номером $i$ помещен на маршруте в позицию $j$.
Если же $D_{i,j}=0$, то оценка внутренних
работ вычисляется обычным способом (см. (\ref{IntPrice})). Данный способ вычисления
внутренних стоимостей используется только во время построения маршрута и
трассы, для их оценки он не используется.

Работа итерационного алгоритма определяется двумя параметрами: $N_1$ и $N_2$.
$N_1$ определяет общее количество итераций, $N_2$ определяет количество
итераций в одном цикле. Смысл цикла итераций заключается в постепенном добавлении
новых коррекций (единиц в матрице $D$) к уже существующим. После завершения
цикла все значения матрицы $D$ сбрасываются в ноль. Далее итерационный метод
использования алгоритма приводится в виде ряда шагов.

1. Выполнение алгоритма без каких-либо коррекций.

2. Выбираем случайным образом позицию $i,i\in \overline{1,N}$, на маршруте.
Пусть в данной позиции располагается мегаполис с номером $j,j\in \overline{1,N}$.
Принимаем $D_{j,i}=1$.

3. Выполняем описанный ранее алгоритм. Вычисляем оценку маршрута и трассы
без коррекций. Если значение оценки улучшилось, то запоминаем данное значение,
а также полученные маршрут, трассу и направления обхода мегаполисов.

4. Выполняем шаги 2 и 3 $N_2-1$ раз ($N_2-2$ раз для первого цикла итераций,
так как в самом начале был произведен счет без коррекций).

5. Обнуляем матрицу $D$.

6. Выполняем шаги 2-5, пока общее количество итераций не достигнет $N_1$.

7. Выбираем лучший результат, а также соответствующие ему маршрут, трассу
и направления обхода мегаполисов.



{\bf Пример 1.} Скорость холостого хода $V_i=500$ мм/с, скорость реза $V_c=10$ мм/с.
Длина финишного участка реза равна 150 мм, ширина области завершения реза 50 мм.
Параметры итерационного метода в обоих примерах $N_1=100$, $N_2=10$,
коэффициент штрафа для внутренних работ $\tilde{P}=1000000$.
Количество контуров $N=170$, количество адресных пар $|\mathbf{K}|=80$.

\begin{figure}
  \begin{center}
  \includegraphics[width=0.9\textwidth]{route_170_approximate_CA.png}
  \caption{Маршрут и трасса обхода множеств. Пример 1. Эвристический алгоритм}
  \label{Sample1Heuristic}
  \end{center}
\end{figure}

Результат счета 532,99, результат на первой итерации 556,15.
Время счета 8 мин. 23 сек.
Маршрут и трасса показаны на рис. \ref{Sample1Heuristic}.

{\bf Пример 2.} Скорость холостого хода $V_i=500$ мм/с, скорость реза $V_c=10$ мм/с.
Длина финишного участка реза равна 150 мм, ширина области завершения реза 50 мм.
Параметры итерационного метода в обоих примерах $N_1=100$, $N_2=10$,
коэффициент штрафа для внутренних работ $\tilde{P}=1000000$.
Количество контуров $N=201$, количество адресных пар $|\mathbf{K}|=56$.

\begin{figure}
  \begin{center}
  \includegraphics[width=0.9\textwidth]{Sample_201_sets_approximate.png}
  \caption{Маршрут и трасса обхода множеств. Пример 2. Эвристический алгоритм}
  \label{Sample2Heuristic}
  \end{center}
\end{figure}

Результат счета 2255679,293, результат без учета штрафов 531,631 (совпадает
со значением на первой итерации). Время счета 1 мин. 40 сек.
Маршрут и трасса показаны на рис. \ref{Sample2Heuristic}.
В данном случае максимальный штраф составил 387001. Учитывая тот факт, что
максимально возможный штраф имеет значение 1000000 (если вся область завершения
реза приходится на пустоты в металле), то можно сделать вывод, что 38\% области
завершения реза пришлось на пустоты в металле для данного контура. Такой
результат может быть естественным следствием очень плотной компановки деталей
и, в принципе, вряд ли является критичным.

{\bf Пример 3.} Скорость холостого хода $V_i=500$ мм/с, скорость реза $V_c=10$ мм/с.
Длина финишного участка реза равна 150 мм, ширина области завершения реза 50 мм.
Решение получено с использованием метода динамического программирования
и эвристического итерационного алгоритма. Коэффициент штрафа для внутренних
работ $\tilde{P}=1000000$. В случае эвристического алгоритма параметры итерационного
метода имели стедующие значения $N_1=10000$, $N_2=10$.
Количество контуров $N=27$, количество адресных пар $|\mathbf{K}|=12$.

\begin{figure}
  \begin{center}
  \includegraphics[width=0.9\textwidth]{Sample_27_sets_DP.png}
  \caption{Маршрут и трасса обхода множеств. Пример 3. Динамическое программирование}
  \label{Sample3DP}
  \end{center}
\end{figure}

Результат счета методом ДП 62,815, результат без учета штрафов 62,815.
Время счета 7 мин. 25 сек.
Маршрут и трасса показаны на рис. \ref{Sample3DP}.

\begin{figure}
  \begin{center}
  \includegraphics[width=0.9\textwidth]{Sample_27_sets_approximate.png}
  \caption{Маршрут и трасса обхода множеств. Пример 3. Эвристический алгоритм}
  \label{Sample3Heuristic}
  \end{center}
\end{figure}

Результат счета эвристическим итерационным методом 243112,454, результат
без учета штрафов 68,495 (для первой итерации 243113,235 и 69,276
соответственно).
Маршрут и трасса показаны на рис. \ref{Sample3Heuristic}.
Максимальный из штрафов составил 176823,72. Можно
сделать вывод, что 17\% области завершения реза пришлось на пустоты для
данного контура, что достаточно неплохо. Время счета 25 сек.

Особенность метода ДП состоит в том, что размерность решаемых с его
использованием примеров ограничена приблизительно четырьмя десятками контуров.
В принципе, такие задачи уже представляют практический интерес (возможны
раскрои такой размерности). Кроме того, метод ДП может использоваться для
грубой оценки приведенного эвристического алгоритма. Именно, предлагается
выполнить вычисления на нескольких десятках примеров эвристическим методом
и методом ДП, после чего сравнить результаты. Ниже приведены результаты
данного сравнения.

Количество примеров равно 25. Высота области, занимаемой контурами, приблизительно
равна одному метру. Ширина колеблется в пределах от одного до двух метров.
Матрицы, используемая для построения значений функций стоимости,
имеет 1500 столбцов и 700 строк.

Скорость холостого хода $V_i=500$ мм/с, скорость реза $V_c=10$ мм/с.
Длина финишного участка реза равна 100 мм, ширина области завершения реза 25 мм.
Параметры итерационного метода во всех примерах $N_1=100$, $N_2=10$,
коэффициент штрафа для внутренних работ $\tilde{P}=1000$.
Количество контуров в каждом из примеров $N=20$.
Количество адресных пар $|\mathbf{K}|$ принимало значение от 2 до 22.
Далее через $T_h$ будем обозначать значение критерия для эвристического
алгоритма, а через $T_{DP}$ - для метода ДП.
В ходе вычислительного эксперимента получены следующие значения критерия.\newline
Пример 4, $T_h=71.41, T_{DP}=66.42$.\newline
Пример 5, $T_h=372.35, T_{DP}=136.89$.\newline
Пример 6, $T_h=67.40, T_{DP}=66.30$.\newline
Пример 7, $T_h=263.41, T_{DP}=66.68$.\newline
Пример 8, $T_h=64.29, T_{DP}=63.18$.\newline
Пример 9, $T_h=70.26, T_{DP}=67.60$.\newline
Пример 10, $T_h=64.41, T_{DP}=62.87$.\newline
Пример 11, $T_h=68.16, T_{DP}=67.07$.\newline
Пример 12, $T_h=139.32, T_{DP}=136.64$.\newline
Пример 13, $T_h=68.30, T_{DP}=66.58$.\newline
Пример 14, $T_h=114.10, T_{DP}=65.53$.\newline
Пример 15, $T_h=70.10, T_{DP}=67.85$.\newline
Пример 16, $T_h=69.00, T_{DP}=66.61$.\newline
Пример 17, $T_h=68.06, T_{DP}=66.83$.\newline
Пример 18, $T_h=66.39, T_{DP}=64.94$.\newline
Пример 19, $T_h=69.83, T_{DP}=68.35$.\newline
Пример 20, $T_h=69.69, T_{DP}=66.46$.\newline
Пример 21, $T_h=68.28, T_{DP}=66.38$.\newline
Пример 22, $T_h=171.85, T_{DP}=65.25$.\newline
Пример 23, $T_h=68.11, T_{DP}=66.39$.\newline
Пример 24, $T_h=308.90, T_{DP}=135.72$.\newline
Пример 25, $T_h=69.05, T_{DP}=67.29$.\newline
Пример 26, $T_h=68.27, T_{DP}=66.16$.\newline
Пример 27, $T_h=221.97, T_{DP}=66.86$.\newline
Пример 28, $T_h=68.78, T_{DP}=66.92$.\newline

{\bf Выводы.} Сравнивая результаты работы эвристического алгоритма и
алгоритма на основе ДП можно отметить следующие моменты. В трех примерах
из 24 найти точное решение без штрафов не удалось. Напомним, штрафы возникают,
если область вокруг участка завершения реза пересекается с отверстиями в металле
или выходит за края листа. Причем в одном случае эвристический алгоритм дал
близкий к оптимальному результат, а в двух других случаях штраф был заметно
больше, чем в случае с ДП. Еще в четырех примерах эвристический алгоритм дал
результат со штрафами.

Максимальное значение критерия для одного из примеров для эвристического алгоритма
равно 372,35. Оптимальный результат для этого примера 136,89 (есть штрафы, величина
которых составляет 68,95). Для ДП стоимость маршрута без учета штрафов 68.09, для
эвристического алгоритма --- 68.95. Таким образом, без учета штрафов результаты счета
очень близки. В случае с эвристическим алгоритмом величина штрафа равна 303,4. Напомним,
что коэффициент штрафа для внутренних работ $\tilde{P}=1000$. Если вся область вокруг
участка завершения реза попадает на пустоты, то штраф для данного контура будет равен
1000. Даже в том случае, если вся величина штрафа 303,4 попала на один контур, менее
трети области вокруг участка завершения реза пересекается с пустотами в металле.
Такой результат представляется вполне приемлемым с практической точки зрения.

Таким образом, данный эвристический алгоритм представляется весьма эффективным.
Что касается алгоритма на основе ДП --- он дает оптимальный результат, что
исключительно важно, но размерость решаемых этим методом примеров лежит в пределах
четырех десятков контуров. Данное обстоятельство накладывает значительные
ограничения на практическое его использование.


\clearpage
\section*{
  Заключительные замечания к разделу II
}

Задача управления инструментом при листовой резке на машинах с ЧПУ является весьма
трудной с точки зрения вычислительной реализации методов, развиваемых на основе
математической теории. При решении конкретных практических задач неизбежным
представляется применение эвристических алгоритмов. Эти алгоритмы могут быть
построены (см. предыдущий раздел) так, что при этом учитываются весьма различные
и плохо формализуемые ограничения. Последнее является, наряду с достаточно высоким
быстродействием и возможностью решать <<большие>> задачи, ценным обстоятельством.
Вместе с тем при их применении могут возникать явные коллизии. Для оперативного
вмешательства с целью <<исправления>> фрагментов ДР и было предложено применять
оптимизирующие вставки.

Данные вставки конструировались так, что оказывалось возможным (на локальном уровне)
использовать методы построения точных решений. Это было достигнуто за счет применения
вставок, приводящих к маршрутным задачам умеренной размерности. Таким образом, в
задачах маршрутизации, имеющих достаточно большую размерность, удалось
<<задействовать>> аппарат ДП, применяемый в режиме итераций, причем сами итерации
могут организовываться, как показано в настоящей главе, по-разному. В частности, в
качестве правила, определяющего конкретное расположение оптимизирующей вставки на
<<эвристическом>> решении, может быть выбран принцип своеобразной максимизации условий
предшествования, <<захватываемых>> данной вставкой, т.е. вовлечение в локальную задачу
как можно большего числа ограничений упомянутого типа. Данный подход, реализованный
в \S 5.4, показывает, что учет некоторых ограничений может играть положительную роль
в вопросах снижения сложности вычислений. Конечно, такой эффект достигается при должной
теоретической проработке, что и было сделано в рамках ДП.

\input{txt/conclude.tex}

\newpage
\printbibliography[heading=bibintoc,title=Список используемых источников]

\input{txt/tail.tex}

\end{document}
