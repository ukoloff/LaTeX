\documentclass{article}
    \usepackage[utf8]{inputenc}
    \usepackage[T2A]{fontenc}
    \usepackage[english,russian]{babel}

    % Related to math
    \usepackage{amsmath,amssymb,amsfonts,amsthm}

    \usepackage{graphicx}
    \graphicspath{{media/}}

    \usepackage{multicol}

\begin{document}

\section{Моделирование маршрута инструмента для машин фигурной листовой резки с ЧПУ. Основные понятия и задачи}

\subsection{Технологии и техники листовой резки на машинах с ЧПУ}

В машиностроении, в производстве металлоконструкций
и в других отраслях промышленности существенная часть продукции
зготавливается из заготовок,
получаемых из листовых материалов на различном технологическом оборудовании.
К такому оборудованию относятся, в частности,
Используемые на предприятиях отечественные и зарубежные
системы автоматизированного проектирования (САПР),
предназначенные для разработки управляющих программ (УП)
для машин листовой резки с ЧПУ (т.н. Computer-Aided Manufacturing, CAM-системы)
обеспечивают автоматизацию процесса разработки УП,
однако не позволяют решить многие оптимизационные задачи.
При этом при моделировании маршрута инструмента пользователям
САПР часто приходится применять интерактивные методы проектирования УП,
поскольку алгоритмы генерации УП,
реализованные в автоматическом режиме проектирования,
во многих случаях не позволяет генерировать оптимальные управляющие программы,
а также обеспечить соблюдение некоторых технологических требований листовой резки.
В качестве критериев оптимизации имеются в виду время резки и
некоторые другие стоимостные характеристики процесса листовой резки.
Проблема разработки методов, алгоритмов и соответствующего программного обеспечения,
позволяющих в автоматическом режиме оптимизировать параметры
процесса резки заготовок из листовых материалов на машинах с числовым программным управлением,
включая алгоритмы маршрутизации движения инструмента,
которые бы обеспечивали минимизацию времени резки и стоимости процесса,
остается актуальнейшей задачей раскройно-заготовительного производства.

Рассмотрим понятие маршрута инструмента (маршрута резки)
применительно к некоторым технологиям фигурной листовой резки.
В настоящее время в промышленном производстве
единичного и мелкосерийного типа для раскроя листовых материалов
используются в основном следующие технологии:
лазерная, плазменная, газовая и гидроабразивная.
Целесообразность их применения определяется различными технологическими факторами,
например, свойствами раскраиваемого материала,
экономическими требованиями к процессу резки,
требованиями к качеству реза и пр.
Эти и некоторые другие технологии резки предполагают,
что для сохранения требуемой геометрии заготовки
траектория движения режущего инструмента не совпадает
с граничным контуром заготовки,
а задается некоторой эквидистантой этого контура,
поскольку часть материала вырезается («сгорает», «вымывается» и пр.)
в процессе резки.
Как правило, дистанция между эквидистантным контуром,
по которому осуществляется резка, и граничным контуром заготовки определяется величиной,
равной половине ширины реза.
Эта величина зависит от выбранной технологии резки,
толщины и марки материала, заданной скорости резки
и особенностей конкретного технологического оборудования,
используемого для резки.

Еще она особенность листовой резки –
необходимость предварительной врезки (пробивки)
материала перед процессом резки непосредственно
по эквидистантному контуру заготовки.
Пробивка материала сопровождается дополнительными
деформациями материала в точке врезки,
поэтому производится на расстоянии (дистанции)
от контура заготовки большем,
чем дистанция до эквидистантного контура за исключением случаев,
когда для точек врезки в листовом материале механическим способом
готовятся (например, просверливаются)
отверстия.
Врезка может также осуществляться
непосредственно на границе материала
(«врезка с края листа»).
В этом случае достигается уменьшение
деформаций материала и сокращается время врезки.

Один из способов резки заготовки (стандартная техника)
показан на Рис. \ref{standard-cutting}.

\begin{figure}
  \begin{center}
  \includegraphics[width=0.9\textwidth]{cutting-path.png}
  \caption{Схема стандартной техники резки (резка по замкнутому контуру)}
  \label{standard-cutting}
  \end{center}
\end{figure}

Если используется стандартная техника резки,
то в этом случае каждый замкнутый контур вырезается целиком,
и после резки одного контура переход к следующей точке врезки
происходит с выключенным инструментом на холостом ходе.
При этом точка выключения инструмента, в общем случае,
может не совпадать с точкой входа в эквидистантный контур заготовки,
по которому осуществляется резка, и также как и точка врезки
может лежать вне заданного эквидистантного контура.
Во многих случаях допускается программирование точки выключения
инструмента непосредственно на эквидистантном контуре.

Стратегия минимизации тепловых деформаций при термической резке
и требования к качеству реза порождают необходимость управления
не только выбором точек врезки,
но и управлением траекторией подхода к контуру (lead-in)
и способом выхода из контура (lead-out).
В зависимости от конкретных условий
(вида термической резки, марки и толщины материала,
скорости резки, геометрической формы контура и пр.)
подход к контуру может осуществляться по дуге окружности,
касательная к которой совпадает с касательной к контуру в точке входа,
либо производиться по прямой линии
(например, по наикратчайшему расстоянию до контура).
Соответственно и после завершения резки выход из контура
также может осуществляться с включенным инструментом
(либо по дуге, либо по прямой линии).
Необходимость выхода из контура с включенным
инструментом может быть вызвана тем,
что в точке выключения инструмента может возникнуть
«вырыв» или оплавление части материала,
что приводит к искажению геометрии заготовки.
Уменьшение эффекта деформации заготовок обеспечивает
также врезка в «угловые» точки заготовок
(Рис. \ref{corner}).

\begin{figure}
  \begin{center}
  \includegraphics[width=0.3\textwidth]{corner.png}
  \caption{Пример врезки «в угол»}
  \label{corner}
  \end{center}
\end{figure}

Примером нестандартной техники
может служить «цепная» резка,
которая заключается в резке нескольких контуров с
использованием одной точки врезки.
При этом каждый контур,
как и в случае применения стандартной техники резки,
вырезается целиком.
На Рис. \ref{chain}
показан пример схемы резки двух заготовок,
в которой резка внешних контуров обеих заготовок
производится без выключения инструмента
с использованием только одной точки врезки.

\begin{figure}
  \begin{center}
  \includegraphics[width=0.5\textwidth]{chain.png}
  \caption{Пример схемы резки двух заготовок с использованием стандартной и «цепной» техники резки}
  \label{chain}
  \end{center}
\end{figure}

Перемещение инструмента в точку врезки
в этом примере начинается из начальной точки на холостом ходу,
а после завершения резки последнего контура
предусмотрен возврат инструмента в начальную точку.

На практике применяется также техника резки
замкнутого контура заготовок по частям
с использованием нескольких точек врезки
с целью формирования т.н. «перемычек»
(Рис. \ref{jumper}),
а также используются другие специальные приёмы,
целью которых является оптимизация различных параметров,
характеризующих процесс резки,
и соблюдение необходимых технологических требований резки.
Техника резки «перемычка» предусматривает
оставление не вырезанной части контура заготовки обычно,
небольшого прямолинейного отрезка или нескольких отрезков,
с резкой этих отрезков после завершения резки оставшейся части контура.
Этот прием применяется с целью уменьшения деформаций материала
при термической резке заготовок, склонных к термическим деформациям,
в частности, длинномерных заготовок.
На рис. \ref{saber} показан пример искажения геометрической формы
(получения т.н. формы «сабли»)
и изменения размера длинномерной прямоугольной заготовки,
вырезаемой без использования техники «перемычка»

\begin{figure}
  \begin{center}
  \includegraphics[width=0.5\textwidth]{jumper.png}
  \caption{Схема формирования перемычки на контуре при резке полосы}
  \label{jumper}
  \end{center}
\end{figure}

\begin{figure}
  \begin{center}
  \includegraphics[width=0.5\textwidth]{saber.png}
  \caption{Результат изменнения формы и размера прямоугольной заготовки при термической резке}
  \label{saber}
  \end{center}
\end{figure}

На Рис. \ref{bridge}
приведен пример использования техники «мост»,
предполагающей  частичную резку замкнутого контура
заготовки с последующим завершением резки контура
после резки контура другой заготовки или
группы контуров других заготовок.
Эта техника используется при резке двух или
нескольких рядом расположенных заготовок и
предусматривает переход по короткой траектории («мосту»)
к резке другой заготовки и возврат к первому контуру
по этой же траектории для завершения процесса резки.
Так же, как и «перемычки»,
мосты существенно уменьшают тепловые деформации материала,
особенно при резке длинномерных заготовок,
кроме того, сокращают число точек врезки.

\begin{figure}
  \begin{center}
  \includegraphics[width=0.5\textwidth]{bridge.png}
  \caption{Схема резки двух полос с использованием техники «мост»}
  \label{bridge}
  \end{center}
\end{figure}

Разновидностью техники мост можно считать технику змейка
(Рис. \ref{snake}),
в которой также используется прием
частичной резки контура и резку
нескольких заготовок без выключения инструмента.

\begin{figure}
  \begin{center}
  \includegraphics[width=0.7\textwidth]{snake.png}
  \caption{Схема резки «змейка»}
  \label{snake}
  \end{center}
\end{figure}

Для уменьшения длины рабочего хода инструмента
применяют т.н. «совмещенный» рез.
Он используется для вырезки заготовок,
которые содержат прямолинейные отрезки в контуре,
и которые в процессе раскроя размещаются таким образом,
что имеют общую границу по одному из таких прямолинейных отрезков.
Общая прямолинейная граница позволяет размещать
заготовки с половинным припуском на рез
(т.е., на ширину реза),
поскольку режется только один раз,
что экономит материал и сокращает суммарную
длину резки на величину совмещенного реза.
Совмещенный рез реализован, в частности,
в технике резки «восьмёрка»,
применяемой для резки двух одинаковых заготовок
(Рис. \ref{8}).
В этом технике используется также идея цепной резки.

\begin{figure}
  \begin{center}
  \includegraphics[width=0.6\textwidth]{8.png}
  \caption{Схема резки «восьмеркой» двух заготовок}
  \label{8}
  \end{center}
\end{figure}

Основные технологические требования
фигурной резки на машинах с ЧПУ обусловлены
необходимостью учёта возникающих деформаций
материала и искажения геометрических размеров
вырезаемых заготовок при использовании
термических технологий резки.
Применение специальных техник позволяет
уменьшить эффект искажения геометрии,
который особенно значителен при
использовании газовой и плазменной технологий.

При использовании любой техники резки маршрут инструмента
машины с ЧПУ для фигурной листовой резки
включает в себя следующие компоненты:
\begin{enumerate}
  \item точки врезки;
  \item рабочий ход инструмента;
  \item точки выключения инструмента;
  \item линейное перемещение инструмента на холостом ходе
  между точкой выключения инструмента и следующей точкой врезки.
\end{enumerate}

При разработке управляющей программы
первое перемещение инструмента обычно
программируется, как на Рис. \ref{chain},
из начальной точки.

Отметим, что некоторые машины фигурной листовой
резки с ЧПУ могут быть укомплектованы с
пециальным видом инструмента,
т.н. трехрезаковым блоком для вырезания
из листа заготовок с одновременной разделкой
кромок поверхности реза для последующей сварки.
Врезка в материал для такого инструмента
программируется специальными способами.
Вопросы применения трехрезакового блока
в рамках данной работы не рассматриваются.
Также мы не будем рассматривать вопросы
маршрутизации инструмента для машин
листовой резки с несколькими суппортами.

Введём некоторые определения,
касающиеся понятия маршрута резки.
В дальнейшем при формальном обозначении
математических и геометрических категорий
мы будем использовать стандартную
теоретико-множественную символику.
Ее детальное описание дано в 3.1.
%%% TODO! Fix reference ^^^^^^^^^^^^^^
Введем следующие определения.

{\bfСегментом резки}
$S=MM^*$
будем называть траекторию рабочего хода
инструмента между точкой врезки
$M$
и соответствующей ей точкой выключения инструмента
$M^*$.
Геометрически сегмент резки представляет собой
определенную на эвклидовой плоскости
$\mathbb R^2$
кривую.
$(S \subset \mathbb R \times \mathbb R;
M=(x,y) \in \mathbb R \times \mathbb R,
M^* =(x^*,y^*)\in \mathbb R \times \mathbb R)$
Будем также полагать,
что в каждой точке траектории определено направление движения инструмента.
Заметим, что если сегмент резки не содержит замкнутых контуров,
то направление движения резки в каждой точке траектории
однозначно определяется начальной точкой сегмента
(точкой врезки).
Замкнутые контуры в траектории рабочего хода инструмента
могут появляться не только в результате резки контуров заготовок,
но и при программировании т.н. петель,
которые используются для повышения качества реза.

Используя понятие сегмента резки,
все техники фигурной резки на машинах с ЧПУ
можно разделить на 3 класса:
\begin{enumerate}
  \item
  {\it Резка по замкнутому контуру (стандартная техника)}:
  в этом случае сегмент резки содержит
  ровно один замкнутый эквидистантный контур заготовки,
  который вырезается целиком.
  \item
  {\it Мульти-сегментная резка контура}:
  в этом случае для вырезки одного контура
  используются не менее двух сегментов резки.
  \item
  {\it Мульти-контурная резка}:
  резка предполагает вырезку нескольких
  контуров в одном сегменте.
\end{enumerate}

Примерами мульти-контурной резки являются,
в частности, приведенные выше техники резки:
«цепная резка», «мост», «змейка» и «восьмерка»,
а примером мульти-сегментной резки –
резка с перемычкой.
На практике используются и другие специальные техники резки,
но все они являются разновидностями техник,
относящихся к одному из определенных выше классов.

При разработке управляющих программ для
машин фигурной листовой резки с ЧПУ чаще всего
применяется стандартная техника резки.
Вместе с тем нередко используются и
комбинации различных техник резки.
Применение той или иной техники резки
при проектировании маршрута резки в
каждом конкретном случае, как правило,
обусловлено либо технологическими требованиями резки,
либо стремлением оптимизировать некоторые
параметры листовой резки.
Подробнее эти вопросы будут рассмотрены ниже.

\subsection{Маршрут резки и оптимизационные задачи маршрутизации инструмента машин листовой резки с ЧПУ}

Для формального определения маршрута резки
введем следующие обозначения.
Пусть
$A_1, A_2, \dots A_n$
– двумерные геометрические объекты (точечные замкнутые множества),
представляющие собой односвязные или
многосвязные области эвклидовой плоскости
$\mathbb R \times \mathbb R$,
ограниченные одной или несколькими замкнутыми кривыми
(граничными контурами)
$C_1, C_2, \dots C_N$
$(A_i, C_J \subset \mathbb R \times \mathbb R;
i \in \overline{1,n};
j \in \overline{1, N};
N \geqslant n)$.
Объекты
$A_1, A_2, \dots A_n$
являются геометрическими моделями плоских заготовок/деталей
({\it в дальнейшем в книге термин «деталь»,
которая вырезается из листового материала,
будет использоваться как синоним термина «заготовка»}).

Пусть также определена область размещения объектов
$B \subset \mathbb R \times \mathbb R$,
которая является геометрической моделью листового материала,
из которого вырезаются детали.
В общем случае область размещения
может содержать несколько кусков материала
(не обязательно прямоугольной формы),
но для решения оптимизационных задач
маршрутизации инструмента целесообразно рассматривать
в качестве области размещения одно замкнутое точечное множество,
ограниченное (как и деталь)
одним внешним контуром.
При этом допустимо наличие отверстий в материале
(внутренних контуров).
Будем полагать, что зафиксирован некоторый вариант размещения
объектов в области размещения,
при этом выполнены условия взаимного не пересечения объектов.
Полагаем также, что выполнены другие дополнительные условия,
обусловленные технологические требованиями резки деталей
на конкретном технологическом оборудовании с ЧПУ,
в частности, условие соблюдения необходимой ширины реза.
Другими словами, фиксированный вариант размещения объектов
является допустимым вариантом раскроя листового материала
для заданного набора $n$ деталей.

Пример размещения в прямоугольной области 24 объектов
($n=24$),
описываемых 30 замкнутыми контурами
($NN=30$)
с заданным минимальным расстоянием между объектами,
приведён на Рис. \ref{nesting}.
Раскройная карта получена с
помощью подсистемы автоматического раскроя CAD/CAM системы «Сириус».

\begin{figure}
  \begin{center}
  \includegraphics[width=0.9\textwidth]{nesting.png}
  \caption{Пример раскроя листа $2000 \times 1000$ мм с заданным минимальным расстоянием между деталями 10 мм}
  \label{nesting}
  \end{center}
\end{figure}

Предположим, что для вырезки деталей было использовано
$K$
сегментов резки
$S_k=M_kM^*_k; k \in \overline{1,K}$.
Тогда маршрут резки деталей можно определить
в терминах сегментов резки как кортеж

\begin{equation}
  ROUTE = (
    M_0, M_1, S_1, M_!^*, M_2, S_2, M_2^*, \dots M_K, S_K, M_K^*, i_1, i_2, \dots i_K
  )
  \label{tuple}
\end{equation}
где
$i_1, i_2, \dots i_K$
– последовательность, в которой вырезаются используемые сегменты резки
$S_1, S_2, \dots S_K$,
$M_0$
– начальная точка положения инструмента.
Линейное перемещение инструмента на холостом ходе
между точкой выключения инструмента и следующей точкой врезки
однозначно определяется этой последовательностью.
Если применить комбинаторную терминологию,
то последовательность однозначно задаётся перестановкой порядка
$K$,
т.е. упорядоченным набором натуральных чисел от $1$ до $K$
(биекцией на множестве $\overline{1,K}$),
которая числу
$k \in \overline{1,K}$
ставит в соответствие элемент
$i_k$ из набора.
Отметим, что термин «маршрут резки» является
общепринятым технологическим понятием.
В главах 3-5 при описании математических моделей оптимизации
маршрута резки мы будем использовать термин «маршрут»
применительно к перестановке
$i_1, i_2, \dots i_K$,
что, в свою очередь, соответствует устоявшейся
терминологии в задаче о последовательном обходе мегаполисов.

\begin{figure}
  \begin{center}
  \includegraphics[width=0.9\textwidth]{cutting.png}
  \caption{Пример маршрута резки, содержащего 24 сегмента резки}
  \label{cutting}
  \end{center}
\end{figure}

На рис. \ref{cutting}
показана схема одного из возможных маршрутов резки для примера,
приведенного на Рис. \ref{nesting}.
Маршрут резки содержит 24 сегмента.
Для резки внешних контуров трёх групп деталей
с точками врезки $M_1$
(три детали в группе),
$M_7$
(четыре детали в группе) и
$M_{11}$
была использована мультиконтурная резка
(указанные группы деталей выделены коричневым цветом).
Все остальные контуры вырезаны с применением стандартной техники резки.
Последовательность резки сегментов соответствует
номерам точек врезки $M_J$ ($J=1,2,\dots 24$).
После вырезки последнего сегмента
возврат инструмента в начальную точку $M_0$
не программировался.

На приведенном рисунке визуализация траектории инструмента
осуществляется точно по граничным контурам деталей,
а не по их эквидистантным контурам, хотя,
как отмечено выше,
траектория реза должна отстоять от
граничного контура на половину ширины реза.
Это связано с тем, что в большинстве CAM – систем
программирование движения инструмента первоначально
осуществляется по граничным контурам деталей,
а вычисление реальной траектории производится
либо непосредственно самой системой ЧПУ,
либо специальной программой-постпроцессором,
предназначенной для конвертирования информации о
маршруте резки из внутреннего формата системы в
формат команд конкретного технологического оборудования с ЧПУ.
В первом случае величину припуска на рез
устанавливает оператор станке перед запуском
управляющей программы резки.

В дальнейшем без ограничения общности мы будем полагать,
что траектория инструмента в маршруте резки $ROUTE$
программируется по граничным контурам,
и сегменты резки
$S_k=M_kM^*_k; k \in \overline{1,K}$
содержат все граничные контуры деталей
$C_1, C_2, \dots C_N$,
т.е.
$$
\bigcup_{j=1}^N C_J \subset \bigcup_{k=1}^K S_K
$$
Соответственно, все точки входа в эквидистантный контур
(и выхода из эквидистантного контура)
(см. Рис. \ref{standard-cutting})
также лежат на граничных контурах.

На рис. \ref{control-program} показан фрагмент управляющей программы
(G-кода) для машины листовой газовой резки
типа «Комета» с системой ЧПУ 2Р32М.

\begin{figure}
\begin{multicols}{3}

  \%УП\_2Р32М\_01
  N1G91 \\
  N2G00X7662Y9909F6000 \\
  N3M70T1 \\
  N4M71T1 \\
  N5G01X-141Y-48F460 \\
  N6X-2400  \\
  N7X-40  \\
  N8X-67  \\
  N9X-2400  \\
  N10X-40 \\
  N11X-67 \\
  N12X-2400 \\
  N13Y-700  \\
  N14X2400  \\
  N15Y700 \\
  N16Y40  \\
  N17X107Y-40 \\
  N18Y-700  \\
  N19X2400  \\
  N20Y700 \\
  N21Y40  \\
  N22X107Y-40 \\
  N23Y-700  \\
  N24X2400  \\
  N25Y700 \\
  N26Y40  \\
  N27M74T1  \\
  N28G00X817Y-8745F6000 \\
  N29M71T1  \\
  N30G03X-108Y0I-54J0F460 \\
  N31G01Y-1048  \\
  N32X-1740 \\
  N33Y400 \\
  N34X940Y900 \\
  N35X800 \\
  N36Y-252  \\
  N37X20Y-30  \\
  … \\
  N314M71T1 \\
  N315G02X-130Y0I-65J0F460  \\
  N316G01Y267 \\
  N317G03X-50Y50I-50J0  \\
  N318G01X-1366 \\
  N319G03X-46Y-31I0J-50 \\
  N320G01X-384Y-960 \\
  N321G03X-4Y-19I46J-19 \\
  N322G01Y-1120 \\
  N323G03X14Y-35I50J0 \\
  N324G01X122Y-121  \\
  N325G03X37Y-14I35J35  \\
  N326G01X1627Y-1 \\
  N327G03X50Y50I0J50  \\
  N328G01Y1933  \\
  N329X20Y30  \\
  N330M74T1 \\
  N331M75T1 \\
  N332M02 \\
  M30
\end{multicols}
\caption{Фрагмент УП для машины листовой резки «Комета» с ЧПУ 2Р32М }
\label{control-program}
\end{figure}

Программа сгенерирована на основе маршрута резки
(спроектированного в интерактивном режиме в CAD/CAM системе «Сириус»
и показанного на Рис. \ref{cutting})
соответствующим постпроцессором со
следующими числовыми параметрами резки:
\begin{itemize}
  \item	Число строк в УП – 333;
  \item	Количество точек врезки (пробивки листа) – 24;
  \item	Путь инструмента на рабочей скорости – 27.36 метров;
  \item	Путь инструмента на быстром (холостом) ходу – 8.39 метров;
  \item	Время движения на рабочей скорости – 62.04 мин.;
  \item	Время движения на быстром (холостом) ходу – 1.64 мин.;
  \item	Общее время резки: 63.68 мин.
\end{itemize}


\end{document}

