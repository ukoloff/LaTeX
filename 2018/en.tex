
\documentclass{../download/tPRS2e}

\usepackage{tikz}
\usetikzlibrary{patterns}
\usepackage{graphicx}
\graphicspath{{media/}}

\begin{document}

\title{Some Optimization Models of Tool Path Problem for Sheet Cutting Machines}

\author{
\name{
Petunin A.A.\textsuperscript{a},
Chentsov P.A.\textsuperscript{b}\textsuperscript{a},
Polishuk E.G.\textsuperscript{a},
Ukolov S.S.\textsuperscript{a}$^{\ast}$\thanks{$^\ast$Corresponding author. Email: s.s.ukolov@urfu.ru}
}
\affil{\textsuperscript{a}Ural Federal University, Yekaterinburg, Russia;
\textsuperscript{b}Institute of Mathematics and Mechanics, Ural Branch of the Russian Academy of Sciences, Yekaterinburg, Russia}
}

\maketitle

\begin{abstract}
TODO
\end{abstract}

\begin{keywords}
    thermal cutting;
    discrete optimization;
    toolpath routing;
    technological constraints;
    dynamic programming;
    thermal deformations
\end{keywords}

\section{Introduction}

The problem of cutting tool path optimization
is one of the applied optimization problems arising
in the design of control programs for CNC plate cutting machines.
The cost or time spent is typically used
as objective function to optimize.
The control program is generated by special software 
(Computer-Aided Manufacturing, CAM-system)
just after another well-known optimization problem
has been solved,
i.e. the problem of nesting
(optimal placement of parts to manufacture on the plate).
The task is to minimize the consumption of sheet material
to produce the parts of known shapes, sizes and quantity.
The example of nesting of 24 parts bounded by 30 closed contours
in rectangular area with minimal distance specified is at Fig. \ref{nesting}.
This nesting was obtained by means of Integrated CAD / CAM ``Sirius''.

\begin{figure}[h]
    \begin{center}
    \includegraphics{nesting.png}
    \caption{Example of nesting to a sheet of $2000 \times 1000$ mm
    with minimal distance of $10$ mm} \label{nesting}
    \end{center}
\end{figure}

The process of figure plate cutting with a CNC machine includes
the following activities:
\begin{itemize}
    \item{Pierce point} (cutting start)
    \item{Actual cutting}
    \item{Turning the cutter off} (cutting end)
    \item{Linear movement from end of cut to start of next cut} (air move)
\end{itemize}

Control program usually starts with an air move from
some starting point. Fig. \ref{toolpath} represents
the scheme of cutting two parts with three pierce points.

\begin{figure}[h]
\begin{center}
\tikz{
    \draw[thick,pattern=north east lines, pattern color=gray,even odd rule, rounded corners=2mm]
        (0, 0) ellipse (3 and 2)
        (-2, -1) rectangle (2, 1);
    \draw[thick,pattern=north east lines]
        (7, -1) ellipse (3 and 2);
    \draw[thick]
        (-3, -3) circle(0.05) node[right] {Start of control program};
}
\caption{Example of cutting tool path for two parts and three pierce points} \label{toolpath}
\end{center}    
\end{figure}

The above figure shows tool path going
along the boundary contours of parts,
while in real life it should be offset to
a half cut width in order to preserve parts geometry and sizes.
From the other hand,
most CAM software assume
the path of cutting tool goes
along parts boundaries,
and actual shift is calculated
by CNC machine itself
or special postprocessing software
while converting tool path
from CAM internal representation
to specific CNC machine language.
In the former case,
exact value of cut allowance
is set by CNC machine operator
just before cutting process.
We will further assume
(if not specified otherwise)
that cutting head path is programmed
directly along bounding contours of the parts to cut,
and final tool path contains all the parts contours.
Due to certain technological requirements
pierce points must lay at some extra distance
from part boundaries.
This leads to appearing of additional component,
named ``lead-in''.
In general,
the point of tool switching off
often lay at some
(another) distance from contour to cut,
the resulting tool path addition
is named ``lead-out''
that goes from part boundary to the cut end.
Sometimes lead-out length is allowed to be zero,
causing cutter head to be switched off
directly at the just cut contour.

Let us introduce some notation for tool path components.

We denote $A_1, A_2, \dots A_n$ -- two-dimensional shapes
(closed sets)
that are single- or multiple-connected
regions of Euclidean plane
$\mathbb R^2$.
They are bounded by one or several closed curves
(bounding contours)
$C_1, C_2, \dots C_N,
A_i, C_j \subset \mathbb R^2,
i \in \overline{1, n},
j \in \overline{1, N},
n \leqslant N)$.
Objects $A_1, A_2, \dots A_n$
represent plain parts to cut.

Let also define plane area
$B \subset \mathbb R^2$,
the model of 
sheet material, from which parts are to be cut out.
In general,
this area can be of arbitrary complex shape
(contain several non-rectangular pieces),
but in context of tool path optimization
we will assume it to be
one closed point set bounded
(as well as a detail) by one outer contour.
The holes
(inner contours) are acceptable either.
We will suppose the nesting
(positon of the parts within $B$)
somehow fixed already,
meeting the condition of
mutual non-inersection.
Some other requirements may also arise
due to specific technlogical features
of CNC equipment used.
Any way,
fixed disposition of
$A_1, A_2, \dots A_n \subset B$
is available to us.

Then we denote $S=MM^*$ -- a cutting segment,
i.e. the path of cutting head
from pierce point $M$
to the corresponding cut end point $M^*$.
In terms of geometry,
cutting segment is a curve at Euclidean plane:
$S \subset \mathbb R^2,
M(x,y) \in \mathbb R^2,
M^*(x^*,y^*) \in \mathbb R^2$.
We suppose
the cut direction is defined
in every point of segment $S$.
In case when there are no
closed loops inside segment,
cut direction at each point of segment
is defined uniquely by the starting
point of segment $M$
(pierce point).
Tool path can contain closed loops
not only as part bounding contours,
but also to improve cutting quality.

Using the notion of cutting segment,
all the CNC machine cutting technics
can be classified as:
\begin{enumerate}
    \item{\textit{Closed contour cutting (standard)}}:
    each segment contains exactly one part contour
    that is cut from start to end
    \item{\textit{Multi-segment cutting}}:
    part contour consists of two (or more) cutting segments
    \item{\textit{Multi-contour cutting}}:
    several part contours are cut at once within one cutting segment
\end{enumerate}

For instance, Fig. \ref{toolpath}
shows cutting path with only
standard cutting used.
Example of multi-contour cutting is at
Fig. \ref{cutting},
it uses nesting from Fig. \ref{nesting}.
There are 24 parts on the sheet.
Three groups of thermalhave been cut with multi-contour cutting:
$M1$ (3 parts),
$M7$ (4 parts) and
$M11$,
marked brown.
All other contours have been cut
with ctandard cutting technique.
Parts are cutted in the order of
pierce points $M_j, j=1, 2, \dots 24$.
Return to starting point $M_0$
after cutting is skipped.

\begin{figure}[h]
    \begin{center}
    \includegraphics{cutting.png}
    \caption{Example of cutting path with 24 cutting segments} \label{cutting}
    \end{center}
\end{figure}

Let's suppose that our parts
($A_1, A_2, \dots A_n$) were cut
using $K$ cutting segments
$S_k = M_kM_k^*, k \in \overline{1, K}$.
Then we define cutting path as tuple
\begin{equation}
    ROUTE = 
    \left< M_0, M_1, S_1, M_1^*, M_2, S_2, M_2^*, \dots, M_K, S_K, M_K^*, i_1, i_2, \dots, i_K\right>
\end{equation}
Here $i_1, i_2, \dots, i_K$ is the sequence of segments
$S_1, S_2, \dots S_K$ processing,
$M_0$ -- starting point of control program.
Linear air moves are impicitly defined by the tuple.
In terms of discrete mathematics,
the sequence is a permutation,
i.e. an ordered set of natural numbers $1\dots K$,
that unambiguously maps every
$K \in \overline{1, K}$ to $i_k$.
As noted before,
we assume tool path to go along
bounding contours of parts
and cutting segments to contain all of them:
$$
\bigcup_{j=1}^N C_j \subset \bigcup_{k=1}^K S_k
$$
Modifying cutting path one can
drastically change numerical parameters
of cutting process.
Therefore a number of optimization problems
arise while developing
control programs for CNC cutting machines.
The most popular objective function
is total cutting time.
In case of thermal or 
hydrobarasive cutting the following formaula applies:
\begin{equation}
    T_{cut} = \frac{L_{on}}{V_{on}} + \frac{L_{off}}{V_{off}} + N_{pt} \cdot t_{pt}
    \label{cut-time}
\end{equation}
Here,
$L_{off}$ is total length of air moves,
$L_{on}$ is total length of cutting segments,
$V_{off}$ is the speed of air move,
$V_{on}$ is the speed of cutting,
$N_{pt}$ is the number of pierce points,
$t_{pt}$ is the time spent in a pierce point,
assuming it is located in the body of sheet.
In some scenarios other kinds of pierce points
can be used
with their own $t_{pt}$ constants.
In that case, equation (\ref{cut-time})
transforms to
\begin{equation}
    T_{cut} = \frac{L_{on}}{V_{on}} + \frac{L_{off}}{V_{off}}
    + \sum_{j=1}^p N_{pt}^j \cdot t_{pt}^j
    \label{piercings}
\end{equation}
Here,
$p$ is a number of pierce point kinds,
$N_{pt}^j$ -- a number of pierce points of kind $j$,
$t_{pt}^j$ -- time to pierce point of kind $j$.
Both in (\ref{cut-time}) and (\ref{piercings}),
$V_{off}$ is a constant dependent on CNC machine used.
Value of $V_{on}$ is to be determined along with
control program development
concerning cutting technology to use
and parameters of sheet material
(including its thickness).
Thus defined $V_{on}$
is often assumed to be a constant value,
but in practice
actual cutting speed depends on
many technological features as well as 
control program itself.
Additional research is required in this area,
some results can be found in [3],
but this is beyond of scope of this article.

Total cost of cutting is another very important
objective function,
especially from economical point of view.
This is rather complex indicator dependent on
electric power consumption,
expendables,
CNC machine maintenance
as well as other operational expenses.

Note that in general cutting cost is not 
proprtional to cutting time,
since it depends on also depends on cutting modes.
It can be estimated like in (\ref{cut-time}):
\begin{equation}
    F_{cost} = L_{on}\cdot C_{on} + L_{off}\cdot C_{off} + N_{pt} \cdot C_{pt}
    \label{cut-cost}
\end{equation}
Where
$C_{on}$ is the unit cost of cutting,
$C_{off}$ is that of air move and
$C_{pt}$ is the cost of a piercing a point,
while $L_{on}, L_{off}$ and $N_{pt}$
make the same sence as in (\ref{cut-time}).
Exact values of unit costs
$C_{on}, C_{off}$ and $C_{pt}$
depend on CNC equipment, cutting technology,
sheet material and its thickness.
This dependency is ususlly summarized
in tabular form or even analitically.

In its turn,
the task of finding appropriate unit costs
$C_{on}, C_{off}$ and $C_{pt}$
for specific equipment and material 
is  low-studied itself.
[4] contains some data concerning this problem
for cutting carbon and stainless stell
as well as aluminium and its alloys
with laser CNC machine ByStar 3015.

When different pierce technologies are used,
(\ref{cut-cost}) becomes
\begin{equation}
    F_{cost} = L_{on}\cdot C_{on} + L_{off}\cdot C_{off}
    + \sum_{j=1}^p C_{pt}^j \cdot t_{pt}^j
    \label{piercings-cost}
\end{equation}
using $C_{pt}^j$ for
cost of piercing of kind $j$.

In any case,
the value of above objective function
depends entirely on the tuple (\ref{toolpath})
elements,
i.e. the cutting path.
In detail,
the geometry of cutting segments
$S_1, S_2, \dots S_K$ gives us
total cutting length $L_{on}$,
while points $M_0, M_1, M_1^*, \dots M_K, M_K^*$
with permutation $i_1, i_2, \dots i_K$
describe air moves hence its total length $L_{off}$.

Therefore,
mentioned above problems
of cutting path optimizations may be
formulated as minimization of some objective function $F$,
defined on set $G$ of addmisible tuples (\ref{toolpath}):
\begin{equation}
    F(ROUTE) \to \min_{ROUTE \in G}
    \label{minimize}
\end{equation}
As tuple contains both
cutting sequence 
$i_1, i_2, \dots i_K$
and cutting start and end points 
$M_kM_k^*, k \in \overline{1, K}$,
the latter located on the Euclidean plane $\mathbb R^2$,
general optimization problem (\ref{minimize})
is a very complex 
continuous-discrete optimization problem,
even with significant restrictions imposed
on admissible segments
$S_1, S_2, \dots S_K$.

This leads to the fact that
there are no general algorithms for solving the problem (\ref{minimize})
described in the scientific literature. 
Nevertheless,
some narrow classes of problems
exist,
that allow efficent optimization algorithms to be developed.
We mention four such classes [4-6].

\begin{enumerate}
    \item{\textbf{Continuous Cutting Problem (CCP)}}:
    the cutter head visits each contour to be cut once.
    The tool can engage the contour at any point on its perimeter,
    but must cut the entire
    contour before it travels to the next contour.
    Accordingly, the same point must be used for
    entry and exit the contour.
    \item{\textbf{Endpoint Cutting Problem (ECP)}}:
    the tool can enter and exit contours only at some
    predefined points on the boundary.
    However, it may cut the contour in sections,
    or stated otherwise: a contour can be pre-empted.
    \item{\textbf{Generalized Traveling Salesman Problem (GTSP)}}:
    the tool path visits each contour to be cut once
    and the tool can engage the contour only
    at some predened points on the boundary.
    \item{\textbf{Segment Continuous Cutting Problem (SCCP)}}:
    cutter head visits each segment to be cut once.
    The tool can engage the segment at any point,
    but must cut the entire segment before it travels to the next segment.
    Note: $CCP \subset SCCP$.
\end{enumerate}

\section*{Acknowledgements}

The work was supported by Act 211 Government of the Russian Federation, contract № 02.A03.21.0006

\bibliographystyle{../download/tPRS}
\nocite{*}
\bibliography{en}

\end{document}
